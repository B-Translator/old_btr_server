<?php

/**
 * @file
 * Test cases for the module l10n_feedback.
 *
 * They can be run from commad line by calling the script:
 *   profiles/btranslator/utils/run-tests.sh
 * The output of the tests is left of the directory
 * 'tests/' under the root of the drupal directory.
 *
 * The script makes a full backup (dump) of the DB
 * before running the tests, and restores it after
 * the tests. The functions setUp() and tearDown()
 * are not used. This is done mostly for performance
 * reasons.
 */

/*
   Some referencies for simpletest:
     + http://drupal.org/simpletest-tutorial-drupal7
     + http://drupal.org/simpletest
     + http://drupal.org/node/278126
     + http://drupal.org/node/265762
     + http://drupal.org/node/265828
 */

/**
 * l10n_feedback test cases
 */
class L10nFeedbackTestCase extends DrupalWebTestCase {

  protected $profile = 'btranslator';

  public static function getInfo() {
    return array(
      'name' => 'l10n_feedback',
      'description' => 'Test the functionality of module l10n_feedback.',
      'group' => 'B-Translator',
    );
  }

  public function setUp() {
    //parent::setUp('l10n_feedback');
    $this->setupUsers();
  }

  public function tearDown() {
  }

  /**
   * Create a test user for each role.
   */
  protected function setupUsers() {

    $role_names = array('contributor', 'translator', 'moderator', 'administrator');
    foreach ($role_names as $role_name) {
      // Create a user of role $role_name
      $role = user_role_load_by_name($role_name);
      $rid = $role->rid;
      $account = $this->drupalCreateUser();
      $this->drupalPost('user/' . $account->uid . '/edit', array("roles[$rid]" => $rid), t('Save'));
      $this->assertText(t('The changes have been saved.'));
      $this->$role_name = $account;
    }
  }

  // Test Case1
  public function testL10nFeedbackCase1() {
    // nothing yet
  }

  // Test Case2
  public function testL10nFeedbackCase2() {
    // nothing yet
  }
}

/**
 * l10n_feedback unit testing
 */
class L10nFeedbackUnitTestCase extends DrupalUnitTestCase {

  public static function getInfo() {
    return array(
      'name' => 'l10n_feedback unit tests',
      'description' => 'Unit testing for module l10n_feedback.',
      'group' => 'l10n',
    );
  }

  function setUp() {
    drupal_load('module', 'l10n_feedback');
    parent::setUp();
  }

  public function testL10nFeedbackUnitTestCase1() {
    // nothing yet
  }
}
